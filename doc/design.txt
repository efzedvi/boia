Block/Ban Offending IP Addresses:

Make use of : Linux::Inotify2 and IO::KQueue
https://wiki.netbsd.org/tutorials/kqueue_tutorial/

Also, always make sure SSH_CLIENT isn't blocked, if it's present

Usage:

boia <options> :

-h, -v (version), -d (daemon), -c <config_file> (default /etc/boia.conf)
-a (act; find and add bad IPs in non daemon mode and then exit)
-t (dry run; only detects and reports bad IPs)
-p (parses the config file)
-l (lists bad IPs in its "DB")
-g (garbage collection; expires old IPs from the "DB")
-r (reload; signals the daemon to reread the config file if it's all good)
-z (delete/zap; removes/unlbocks all the bad IPs it has found)

Config file:


[global]
cache = /var/lib/biab/badips.csv

blockcmd = <optional>  (passes: %ip, %date, %app_name=boia)
unblockcmd = <optional>
zapcmd = <optional>

mail_to = mail address (sends IP)

myhosts = list of hosts, and/or IPs, netmasks
blocktime = NNd | NNh | NNm | NNs
numfails = 1


[/var/log/mail.log]

active = [true | false]
port = optional list of ports (or names) 
protocol = <optional>
regex =
ip=%1
blockcmd = <optional>  (passes: %ip, %protocol, %port(s), %timestamp, %section)
unblockcmd = <optional> 
zapcmd = <optional>

blocktime = NNd | NNh | NNm | NNs
numfails = 1


